<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="UTF-8">
    <title>表格转换</title>
</head>
<link rel="stylesheet" href="/layui/css/layui.css">
<link rel="stylesheet" href="/layui_ext/dtree/dtree.css">
<link rel="stylesheet" href="/layui_ext/dtree/font/dtreefont.css">
<script type="text/javascript" src="/layui/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="/layui/layui.js"></script>
<!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
<!--[if lt IE 9]>-->
<script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
<script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<script th:inline="javascript">
    layui.use('form', function(){
        var form = layui.form;
        //监听提交
        //checkbox 点击事件
    });
    //导入表格
    layui.use('upload',function () {
        var upload = layui.upload; //得到 upload 对象

        //创建一个上传组件
        upload.render({
            elem: '#in'
            ,url: '/rtc/input'
            ,done: function(res, index, upload){ //上传后的回调
                if(res["ok"]!=null){
                    document.location.href="/rtc/out";
                }else if(res["error"]!=null){
                    layer.alert(res["error"]);
                }else {
                    layer.alert(res["error"]);
                }
            }
            ,error:function () {
                layer.alert("上传错误");
            }
            ,acceptMime: 'file/xlsx'
            ,accept: 'file' //允许上传的文件类型
            ,size:10000
            //,size: 50 //最大允许上传的文件大小
            //,……
        });
    });

</script>
<body>
<div class="layui-row" style="background-color: #D0D0D0;margin-bottom: 3%;padding: 1%;border: #4E5465 1px">
    <p>excel转换</p>
</div>
<div class="layui-container"  style="width: 90%">
    <div class="layui-form">
        <div class="layui-form-item">
            <div class="layui-inline">
                <div class="layui-btn-group">
                    <button class="layui-btn layui-btn-lg" id="in" lay-filter="upload" > <i class="layui-icon">&#xe67c;</i>ZenTao2Rtc</button>
                    <button class="layui-btn layui-btn-lg" id="rein" lay-filter="rtc_id_upload" > <i class="layui-icon">&#xe67c;</i>Rtc id导入</button>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>